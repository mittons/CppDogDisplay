cmake_minimum_required(VERSION 3.10)
cmake_policy(SET CMP0091 NEW)
cmake_policy(SET CMP0079 NEW)
project(DogDisplayForCpp01)

option(PRODUCTION "Build for production" OFF)

if(PRODUCTION)
    add_definitions(-DPRODUCTION)
     add_definitions(-DDOG_SERVICE_BASE_URL=\"https://nodedogroute-38a170d08520.herokuapp.com\")
else()
    # Set development-specific settings
endif()


set(PROJECT_VERSION_MAJOR 0)
set(PROJECT_VERSION_MINOR 1)
set(PROJECT_VERSION_PATCH 3)


set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

if(CMAKE_SYSTEM_NAME STREQUAL "Windows")
    add_definitions(-D_WIN32_WINNT=0x0A00)
endif()

find_package(inja REQUIRED)
find_package(Crow CONFIG REQUIRED)
find_package(nlohmann_json CONFIG REQUIRED)
find_package(cpr CONFIG REQUIRED)
find_package(GTest REQUIRED)

# Add the main application directory
add_subdirectory(src)


# Copy the signature file to build src
configure_file(
    "${CMAKE_SOURCE_DIR}/src/sign.py"
    "${CMAKE_BINARY_DIR}/src/sign.py"
    COPYONLY
)

# Copy the signature file to build tests
configure_file(
    "${CMAKE_SOURCE_DIR}/src/sign.py"
    "${CMAKE_BINARY_DIR}/tests/sign.py"
    COPYONLY
)

# Enable Google Test
enable_testing()




# Add the tests directory
add_subdirectory(tests)